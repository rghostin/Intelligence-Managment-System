{% extends 'frontend/base.html' %}
{% load static %}
{% load rest_framework %}

{% block page_title %}Add intel{% endblock %}


{% block page_content %}
    <div class="content">
        <div class="block">
            <div class="block-header">
                <h3 class="block-title">Labels on top</h3>
            </div>
            <div class="block-content block-content-full">
                <div class="row">
                    <div class="col-lg-4">
                        <p class="font-size-sm text-muted">
                            An often used layout which is very easy to create with minimal markup
                        </p>
                    </div>
                    <div class="col-lg-8">
                        {# Base Intel form #}
                        <form action="{% url 'intels-list' %}" method="POST" id="id_create_form">
                            {% csrf_token %}
                            {% render_form intel_serializer %}
                        </form>

                        {# Intel Files #}
                        <div class="form-group">
                            <label class="d-block" for="id_input_files">Files</label>
                            <input class="form-control-file" name="file" type="file" value="" id="id_input_files" multiple>
                        </div>

                        <div class="form-group" style="text-align: right;" >
                            <button class="btn btn-primary" id="id_create_btn">Create</button>
                        </div>

                    </div>
                </div>
            </div>

        </div>

    </div>
{% endblock %}

{% block custom_js %}
    <script src="{% static "frontend/assets/javascript/create.js" %}"></script>

    <script>
        $(document).ready(function () {
            var api_endpoint_intel = "{% url 'intels-list' %}";
            var api_endpoint_intelfiles = "{%  url 'intelfiles-list' %}";
            var csrf_token = "{{ csrf_token }}";

            $("#id_create_btn").click( function (e) {
                e.preventDefault();
                create_intel(api_endpoint_intel, api_endpoint_intelfiles, csrf_token, $("#id_create_form").serialize() );
            });
        });
    </script>
{% endblock %}